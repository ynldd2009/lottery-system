{% extends "base.html" %}

{% block title %}é¦–é¡µ - å½©ç¥¨åˆ†æé¢„æµ‹ç³»ç»Ÿ{% endblock %}

{% block content %}
<div class="hero">
    <h1>ğŸ° å½©ç¥¨åˆ†æé¢„æµ‹ç³»ç»Ÿ</h1>
    <p class="subtitle">æ”¯æŒç”µè„‘å’Œæ‰‹æœºè®¿é—®çš„æ™ºèƒ½å½©ç¥¨åˆ†æå¹³å°</p>
</div>

<!-- Real-time Information Section -->
<div class="info-section home-realtime">
    <div class="realtime-info">
        <p id="current-time" class="time-display">ğŸ• å½“å‰æ—¶é—´: åŠ è½½ä¸­...</p>
        <p id="deadline-info" class="deadline-display">â° è´­ä¹°æˆªæ­¢: åŠ è½½ä¸­...</p>
    </div>
    <div id="announcement" class="announcement-banner">
        ğŸ¯ æ¬¢è¿ä½¿ç”¨å½©ç¥¨åˆ†æç³»ç»Ÿ
    </div>
</div>

<!-- Latest Results Section -->
<div class="info-section">
    <h2>æœ€æ–°å¼€å¥–ä¿¡æ¯</h2>
    <div class="latest-results">
        <table id="results-table" class="table">
            <thead>
                <tr>
                    <th>å½©ç¥¨ç±»å‹</th>
                    <th>æœŸå·</th>
                    <th>å¼€å¥–æ—¥æœŸ</th>
                    <th>å¼€å¥–å·ç </th>
                    <th>çŠ¶æ€</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="5" style="text-align: center;">åŠ è½½ä¸­...</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div class="features-grid">
    <div class="feature-card">
        <div class="feature-icon">ğŸ“Š</div>
        <h3>æ•°æ®åˆ†æ</h3>
        <p>é¢‘ç‡åˆ†æã€å†·çƒ­å·ç ã€æ¨¡å¼æ£€æµ‹</p>
        <a href="/analysis" class="btn btn-primary">å¼€å§‹åˆ†æ</a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">ğŸ”®</div>
        <h3>æ™ºèƒ½é¢„æµ‹</h3>
        <p>7ç§ç»Ÿè®¡æ¨¡å‹ï¼Œé›†æˆé¢„æµ‹ç®—æ³•</p>
        <a href="/prediction" class="btn btn-primary">ç”Ÿæˆé¢„æµ‹</a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">ğŸ’¾</div>
        <h3>æ•°æ®ç®¡ç†</h3>
        <p>å¯¼å…¥å¯¼å‡ºCSVã€JSONã€Excel</p>
        <a href="/data" class="btn btn-primary">ç®¡ç†æ•°æ®</a>
    </div>

    <div class="feature-card">
        <div class="feature-icon">ğŸ› ï¸</div>
        <h3>å®ç”¨å·¥å…·</h3>
        <p>å¯†ç ç”Ÿæˆã€è®°å½•ç®¡ç†</p>
        <a href="/utilities" class="btn btn-primary">ä½¿ç”¨å·¥å…·</a>
    </div>
</div>

<div class="info-section">
    <h2>æ”¯æŒçš„å½©ç¥¨ç±»å‹</h2>
    <div class="lottery-types">
        {% for lottery_type in lottery_types %}
        <span class="badge">{{ lottery_type }}</span>
        {% endfor %}
    </div>
</div>

<div class="info-section">
    <h2>é¢„æµ‹æ¨¡å‹</h2>
    <div class="models-list">
        <ul>
            <li><strong>é¢‘ç‡åˆ†æ</strong> - åŸºäºå†å²å‡ºç°é¢‘ç‡</li>
            <li><strong>å†·çƒ­å·ç </strong> - è¯†åˆ«çƒ­å·å’Œå†·å·</li>
            <li><strong>æ¨¡å¼å¹³è¡¡</strong> - å¥‡å¶ã€é«˜ä½å¹³è¡¡</li>
            <li><strong>åŠ æƒé¢‘ç‡</strong> - è¿‘æœŸæ•°æ®åŠ æƒ</li>
            <li><strong>é—´éš”åˆ†æ</strong> - é¢„æµ‹"åˆ°æœŸ"å·ç </li>
            <li><strong>ç§»åŠ¨å¹³å‡</strong> - è¶‹åŠ¿åˆ†æ</li>
            <li><strong>å‘¨æœŸæ¨¡å¼</strong> - å‘¨æœŸæ£€æµ‹</li>
        </ul>
    </div>
</div>

<script>
// Update homepage info every second
function updateHomepageInfo() {
    fetch('/api/homepage-info')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Update time
                document.getElementById('current-time').textContent = `ğŸ• å½“å‰æ—¶é—´: ${data.current_time}`;
                
                // Update deadline with countdown
                const deadlineDiv = document.getElementById('deadline-info');
                if (data.deadline_info && data.deadline_info.length > 0) {
                    let deadlineHTML = 'â° æŠ•æ³¨å€’è®¡æ—¶ï¼š';
                    data.deadline_info.forEach((item, index) => {
                        if (index > 0) deadlineHTML += ' | ';
                        const style = item.urgent ? 'color: red; font-weight: bold;' : '';
                        deadlineHTML += `<span style="${style}">${item.text} (${item.time}) è¿˜å‰© ${item.countdown}</span>`;
                    });
                    deadlineDiv.innerHTML = deadlineHTML;
                } else {
                    deadlineDiv.textContent = 'â° ä»Šæ—¥å½©ç¥¨é”€å”®å·²æˆªæ­¢';
                }
                
                // Update announcement
                document.getElementById('announcement').textContent = data.announcement;
                
                // Update results table
                const tbody = document.querySelector('#results-table tbody');
                tbody.innerHTML = '';
                data.latest_results.forEach(result => {
                    const row = tbody.insertRow();
                    row.insertCell(0).textContent = result.lottery;
                    row.insertCell(1).textContent = result.period || '';
                    row.insertCell(2).textContent = result.date;
                    row.insertCell(3).textContent = result.numbers;
                    row.insertCell(4).textContent = result.status;
                });
            }
        })
        .catch(error => {
            console.error('Error updating homepage info:', error);
        });
}

// Initial update
updateHomepageInfo();

// Update every second
setInterval(updateHomepageInfo, 1000);
</script>

<style>
.home-realtime {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 30px;
}

.realtime-info {
    text-align: center;
}

.time-display, .deadline-display {
    font-size: 1.1em;
    margin: 10px 0;
}

.announcement-banner {
    background: #ffe4b5;
    color: #333;
    padding: 15px;
    border-radius: 5px;
    text-align: center;
    margin-top: 15px;
    font-weight: bold;
}

.latest-results {
    overflow-x: auto;
}

.table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

.table th, .table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.table th {
    background-color: #f4f4f4;
    font-weight: bold;
}

.table tbody tr:hover {
    background-color: #f9f9f9;
}

@media (max-width: 768px) {
    .time-display, .deadline-display {
        font-size: 0.95em;
    }
    
    .table th, .table td {
        padding: 8px;
        font-size: 0.9em;
    }
}
</style>

{% endblock %}
